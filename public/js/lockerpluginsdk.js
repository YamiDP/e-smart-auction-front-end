!function e(t,i,n){function o(s,c){if(!i[s]){if(!t[s]){var u="function"==typeof require&&require;if(!c&&u)return u(s,!0);if(r)return r(s,!0);var a=new Error("Cannot find module '"+s+"'");throw a.code="MODULE_NOT_FOUND",a}var l=i[s]={exports:{}};t[s][0].call(l.exports,(function(e){return o(t[s][1][e]||e)}),l,l.exports,e,t,i,n)}return i[s].exports}for(var r="function"==typeof require&&require,s=0;s<n.length;s++)o(n[s]);return o}({1:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.LockerPlugin=void 0;var n=e("./common/SubscriptionType"),o=e("./subscription/SubscriptionService"),r=e("./LockerPluginService"),s=e("./ui/DocumentGenerator"),c=e("./MessageDispatcher"),u=function(){function e(e){this.window=e,this.firstTimeInit=!0,this.subscriptionService=new o.SubscriptionService}return e.prototype.getInstance=function(){return this},e.prototype.init=function(e){void 0===this.options&&(this.options={clientId:null==e?void 0:e.clientId,countryCode:null==e?void 0:e.countryCode,langCode:null==e?void 0:e.langCode,county:null==e?void 0:e.county,city:null==e?void 0:e.city,favLockerId:null==e?void 0:e.favLockerId,theme:null==e?void 0:e.theme,apiUsername:null==e?void 0:e.apiUsername,filters:null==e?void 0:e.filters})},e.prototype.subscribe=function(e){this.subscriptionService.subscribe(n.SubscriptionType.SelectLocker,e)},e.prototype.subscribeToFavouriteLocker=function(e){this.subscriptionService.subscribe(n.SubscriptionType.FavouriteLocker,e)},e.prototype.open=function(){if(this.firstTimeInit){var e=new s.DocumentGenerator(this.window.document,this.options).generate();return this.lockerPluginService=new r.LockerPluginService(e),this.setupCommunication(),void(this.firstTimeInit=!1)}this.lockerPluginService.open()},e.prototype.close=function(){this.lockerPluginService.close()},e.prototype.setupCommunication=function(){new c.MessageDispatcher(this.subscriptionService,this.lockerPluginService).setup(this.window)},e}();i.LockerPlugin=u},{"./LockerPluginService":2,"./MessageDispatcher":3,"./common/SubscriptionType":5,"./subscription/SubscriptionService":7,"./ui/DocumentGenerator":8}],2:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.LockerPluginService=void 0;var n=e("./Settings"),o=function(){function e(e){this.elements=e,this.setupModalCloseButton(),this.setupModalOpenOnLoad()}return e.prototype.sendHostValidationMsg=function(){this.postMessage("ValidateThisHost")},e.prototype.sendModalClosedMsg=function(){this.postMessage("ModalClosed")},e.prototype.sendModalOpenMsg=function(){this.postMessage("ModalOpen")},e.prototype.postMessage=function(e){this.elements.iframe.contentWindow.postMessage(e,n.Settings.appOrigin)},e.prototype.open=function(){this.elements.modalDiv.style.display="block",this.sendModalOpenMsg()},e.prototype.close=function(){this.elements.modalDiv.style.display="none"},e.prototype.setupModalOpenOnLoad=function(){this.elements.iframe.addEventListener("load",this.open.bind(this))},e.prototype.setupModalCloseButton=function(){var e=this;this.elements.closeSpan.addEventListener("click",(function(){e.elements.modalDiv.style.display="none",e.sendModalClosedMsg()}))},e}();i.LockerPluginService=o},{"./Settings":4}],3:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.MessageDispatcher=void 0;var n=e("./Settings"),o=function(){function e(e,t){this.subscriptionService=e,this.lockerPluginService=t}return e.prototype.setup=function(e){e.addEventListener("message",this.messageDispatcher.bind(this))},e.prototype.messageDispatcher=function(e){if(e.origin===n.Settings.appOrigin)try{if("lockerPluginReady"===e.data)return void this.lockerPluginService.sendHostValidationMsg();var t=e.data;console.log("message received",t),this.subscriptionService.postMessage(t.subscription,t.object)}catch(e){}},e}();i.MessageDispatcher=o},{"./Settings":4}],4:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.Settings=void 0;var n=function(){function e(){}return Object.defineProperty(e,"sdkBaseUrl",{get:function(){return"https://cdn.sameday.ro/locker-plugin"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"appBaseUrl",{get:function(){return"https://cdn.sameday.ro/locker-plugin"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"sdkOrigin",{get:function(){return e.getOrigin(e.sdkBaseUrl)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"appOrigin",{get:function(){return e.getOrigin(e.appBaseUrl)},enumerable:!1,configurable:!0}),e.getOrigin=function(e){return new URL(e).origin},e}();i.Settings=n},{}],5:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.SubscriptionType=void 0,function(e){e.SelectLocker="SelectLocker",e.FavouriteLocker="FavouriteLocker"}(i.SubscriptionType||(i.SubscriptionType={}))},{}],6:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("./LockerPlugin");window.LockerPlugin=new n.LockerPlugin(window)},{"./LockerPlugin":1}],7:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.SubscriptionService=void 0;var n=function(){function e(){this.subscriptions={}}return e.prototype.subscribe=function(e,t){this.subscriptions[e]=t},e.prototype.postMessage=function(e,t){var i=this.subscriptions[e];i&&i(t)},e}();i.SubscriptionService=n},{}],8:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.DocumentGenerator=void 0;var n=e("./ElementId"),o=e("../Settings"),r=function(){function e(e,t){this.document=e,this.options=t}return e.prototype.generate=function(){return this.generateCss(),this.generateHtml(this.options)},e.prototype.createMetaViewport=function(){var e=this.document.createElement("meta");return e.name="viewport",this.document.head.appendChild(e),e},e.prototype.setMetaViewport=function(){for(var e=this.document.head.querySelectorAll("meta[name='viewport']"),t=0===e.length?this.createMetaViewport():e[0],i=1;i<e.length;++i)e[i].remove();t.content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"},e.prototype.generateHtml=function(e){this.setMetaViewport();var t=this.document.createElement("iframe");t.src=this.getAppUrl(e).href,t.className="locker-plugin-iframe",t.allow="geolocation",t.id="locker-plugin-iframe";var i=this.document.createElement("div");i.style.display="none",i.className="locker-plugin-modal",i.id=n.ElementId.modalDivId;var o=this.document.createElement("div");o.className="locker-plugin-modal-content";var r=this.document.createElement("span");return r.innerHTML="X",r.id=n.ElementId.closeModalId,r.className="locker-plugin-modal-close",o.appendChild(t),o.appendChild(r),i.appendChild(o),this.document.getElementsByTagName("body")[0].appendChild(i),{modalDiv:i,closeSpan:r,iframe:t}},e.prototype.getAppUrl=function(e){for(var t=new URL("".concat(o.Settings.appBaseUrl,"/index.html")),i=0,n=Object.entries(e);i<n.length;i++){var r=n[i],s=r[0],c=r[1];if(c){var u=Array.isArray(c)?JSON.stringify(c):c;t.searchParams.append(s,u)}}return t},e.prototype.generateCss=function(){var e=this.document.createElement("link");e.rel="stylesheet",e.type="text/css",e.href="".concat(o.Settings.sdkBaseUrl,"/lockerpluginsdk.css"),this.document.head.appendChild(e)},e}();i.DocumentGenerator=r},{"../Settings":4,"./ElementId":9}],9:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.ElementId=void 0;var n=function(){function e(){}return e.closeModalId="locker-plugin-modal-close-id",e.modalDivId="locker-plugin-modal-id",e}();i.ElementId=n},{}]},{},[6]);
//# sourceMappingURL=lockerpluginsdk.js.map
